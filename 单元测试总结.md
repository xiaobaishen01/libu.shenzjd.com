# ğŸ“Š å•å…ƒæµ‹è¯•æ€»ç»“

## âœ… æµ‹è¯•æ¦‚è§ˆ

### æµ‹è¯•ç»Ÿè®¡
- **æµ‹è¯•å¥—ä»¶**: 3ä¸ªå…¨éƒ¨é€šè¿‡
- **æµ‹è¯•ç”¨ä¾‹**: 52ä¸ªå…¨éƒ¨é€šè¿‡
- **æµ‹è¯•è¦†ç›–ç‡**: æ ¸å¿ƒå·¥å…·å‡½æ•°å…¨è¦†ç›–
- **è¿è¡Œæ—¶é—´**: ~0.5ç§’

---

## ğŸ“ æµ‹è¯•æ–‡ä»¶ç»“æ„

```
src/lib/
â”œâ”€â”€ crypto.test.ts      # åŠ å¯†æœåŠ¡æµ‹è¯• (14ä¸ªæµ‹è¯•)
â”œâ”€â”€ utils.test.ts       # å·¥å…·å‡½æ•°æµ‹è¯• (19ä¸ªæµ‹è¯•)
â””â”€â”€ github.test.ts      # GitHub APIæµ‹è¯• (19ä¸ªæµ‹è¯•)
```

---

## ğŸ” crypto.test.ts - åŠ å¯†æœåŠ¡æµ‹è¯• (14ä¸ª)

### æµ‹è¯•å†…å®¹

#### 1. HashåŠŸèƒ½ (5ä¸ªæµ‹è¯•)
```typescript
âœ“ should generate consistent hash for the same input
âœ“ should generate different hashes for different inputs
âœ“ should handle empty string
âœ“ should handle special characters
âœ“ should handle unicode characters
```

**éªŒè¯ç‚¹**:
- SHA-256å“ˆå¸Œä¸€è‡´æ€§
- ä¸åŒè¾“å…¥äº§ç”Ÿä¸åŒå“ˆå¸Œ
- è¾¹ç•Œæƒ…å†µå¤„ç†ï¼ˆç©ºå­—ç¬¦ä¸²ã€ç‰¹æ®Šå­—ç¬¦ã€emojiï¼‰

#### 2. åŠ å¯†/è§£å¯† (7ä¸ªæµ‹è¯•)
```typescript
âœ“ should encrypt and decrypt data correctly
âœ“ should produce different encrypted strings for same data
âœ“ should fail to decrypt with wrong password
âœ“ should handle empty data object
âœ“ should handle complex nested objects
âœ“ should handle string data
âœ“ should handle array data
```

**éªŒè¯ç‚¹**:
- AES-256åŠ å¯†è§£å¯†æ­£ç¡®æ€§
- IVéšæœºæ€§ï¼ˆç›¸åŒæ•°æ®ä¸åŒåŠ å¯†ç»“æœï¼‰
- é”™è¯¯å¯†ç è¿”å›null
- å„ç§æ•°æ®ç±»å‹æ”¯æŒ

#### 3. é›†æˆæµ‹è¯• (2ä¸ªæµ‹è¯•)
```typescript
âœ“ should handle round-trip encryption with real-world data
âœ“ should verify password with hash
```

**éªŒè¯ç‚¹**:
- å®Œæ•´äº‹ä»¶æ•°æ®åŠ å¯†è§£å¯†
- å¯†ç å“ˆå¸ŒéªŒè¯æµç¨‹

---

## ğŸ› ï¸ utils.test.ts - å·¥å…·å‡½æ•°æµ‹è¯• (19ä¸ª)

### æµ‹è¯•å†…å®¹

#### 1. IDç”Ÿæˆ (3ä¸ªæµ‹è¯•)
```typescript
âœ“ should generate a valid ID
âœ“ should generate unique IDs
âœ“ should generate IDs with reasonable length
```

**éªŒè¯ç‚¹**:
- IDæ ¼å¼æ­£ç¡®æ€§
- å”¯ä¸€æ€§ä¿è¯
- é•¿åº¦åˆç†æ€§

#### 2. è´§å¸æ ¼å¼åŒ– (5ä¸ªæµ‹è¯•)
```typescript
âœ“ should format numbers correctly with CNY symbol
âœ“ should handle negative numbers
âœ“ should handle large numbers
âœ“ should handle edge cases
âœ“ should handle null/undefined gracefully
```

**éªŒè¯ç‚¹**:
- CNYç¬¦å·æ˜¾ç¤º
- è´Ÿæ•°å¤„ç†
- å¤§æ•°å­—æ ¼å¼åŒ–
- å°æ•°ç²¾åº¦å¤„ç†

#### 3. ä¸­æ–‡å¤§å†™é‡‘é¢è½¬æ¢ (8ä¸ªæµ‹è¯•)
```typescript
âœ“ should convert small numbers correctly
âœ“ should convert medium numbers
âœ“ should handle numbers with decimals
âœ“ should handle zero
âœ“ should handle complex numbers
âœ“ should handle edge cases with zeros
âœ“ should handle non-number input
```

**éªŒè¯ç‚¹**:
- 1-9: å£¹-ç–
- 10-100: æ‹¾-ä½°
- 1000+: ä»Ÿ-ä¸‡-æ‹¾ä¸‡-ä½°ä¸‡
- è§’åˆ†å¤„ç†
- é›¶çš„å¤„ç†ï¼ˆè¿ç»­é›¶ã€æœ«å°¾é›¶ï¼‰

**ç¤ºä¾‹**:
```
100.5 â†’ "å£¹ä½°å…ƒä¼è§’æ•´"
123.45 â†’ "å£¹ä½°è´°æ‹¾åå…ƒè‚†è§’ä¼åˆ†"
10001.1 â†’ "å£¹ä¸‡é›¶å£¹å…ƒå£¹è§’æ•´"
```

#### 4. æ—¥æœŸæ—¶é—´ (4ä¸ªæµ‹è¯•)
```typescript
âœ“ should return current date and time
âœ“ should return date in YYYY-MM-DD format
âœ“ should return time in HH:MM format
âœ“ should return reasonable current values
```

**éªŒè¯ç‚¹**:
- æ ¼å¼æ­£ç¡®æ€§
- å®æ—¶æ€§
- è¾¹ç•Œå€¼éªŒè¯

---

## ğŸ™ github.test.ts - GitHub APIæµ‹è¯• (19ä¸ª)

### æµ‹è¯•å†…å®¹

#### 1. è¿æ¥æµ‹è¯• (4ä¸ªæµ‹è¯•)
```typescript
âœ“ should create instance with config
âœ“ should return true when connection succeeds
âœ“ should return false when connection fails
âœ“ should call correct GitHub API endpoint
```

**éªŒè¯ç‚¹**:
- å®ä¾‹åŒ–æ­£ç¡®
- è¿æ¥æˆåŠŸ/å¤±è´¥å¤„ç†
- APIç«¯ç‚¹å’Œè®¤è¯å¤´æ­£ç¡®

#### 2. æ–‡ä»¶è¯»å– (3ä¸ªæµ‹è¯•)
```typescript
âœ“ should read file successfully
âœ“ should return null when file not found
âœ“ should return null on error
```

**éªŒè¯ç‚¹**:
- Base64è§£ç 
- 404å¤„ç†
- ç½‘ç»œé”™è¯¯å¤„ç†

#### 3. æ–‡ä»¶å†™å…¥ (3ä¸ªæµ‹è¯•)
```typescript
âœ“ should write new file successfully
âœ“ should update existing file with sha
âœ“ should handle write errors
```

**éªŒè¯ç‚¹**:
- æ–°æ–‡ä»¶åˆ›å»º
- ç°æœ‰æ–‡ä»¶æ›´æ–°ï¼ˆåŒ…å«SHAï¼‰
- é”™è¯¯ä¼ æ’­

#### 4. åŒæ­¥åŠŸèƒ½ (2ä¸ªæµ‹è¯•)
```typescript
âœ“ should sync events successfully
âœ“ should handle complex event data
```

**éªŒè¯ç‚¹**:
- äº‹ä»¶æ•°æ®åŒæ­¥
- Unicode/ç‰¹æ®Šå­—ç¬¦æ”¯æŒ

#### 5. é›†æˆåœºæ™¯ (2ä¸ªæµ‹è¯•)
```typescript
âœ“ should handle complete workflow
âœ“ should handle rate limiting response
```

**éªŒè¯ç‚¹**:
- å®Œæ•´å·¥ä½œæµï¼šè¿æ¥â†’è¯»å–â†’å†™å…¥
- GitHub APIé™åˆ¶å¤„ç†

#### 6. é”™è¯¯å¤„ç† (2ä¸ªæµ‹è¯•)
```typescript
âœ“ should handle malformed JSON in response
âœ“ should handle network timeouts
```

**éªŒè¯ç‚¹**:
- å“åº”è§£æé”™è¯¯
- ç½‘ç»œè¶…æ—¶

---

## ğŸ¯ æµ‹è¯•ç­–ç•¥

### Mockç­–ç•¥
```typescript
// Mockå…¨å±€fetch
global.fetch = jest.fn();

// æ¯æ¬¡æµ‹è¯•å‰æ¸…é™¤mock
beforeEach(() => {
  jest.clearAllMocks();
});
```

### æµ‹è¯•æ¨¡å¼
1. **Happy Path**: æ­£å¸¸æµç¨‹éªŒè¯
2. **Edge Cases**: è¾¹ç•Œå€¼å¤„ç†
3. **Error Handling**: é”™è¯¯æ¢å¤èƒ½åŠ›
4. **Integration**: ç«¯åˆ°ç«¯æµç¨‹

### æ–­è¨€ç±»å‹
- `expect().toBe()` - ä¸¥æ ¼ç›¸ç­‰
- `expect().toEqual()` - æ·±åº¦ç›¸ç­‰
- `expect().toBeTruthy()` - çœŸå€¼
- `expect().toThrow()` - å¼‚å¸¸
- `expect().toMatch()` - æ­£åˆ™åŒ¹é…

---

## ğŸ“ˆ ä»£ç è¦†ç›–ç‡

### å®é™…è¦†ç›–ç‡ç»Ÿè®¡
```
-----------|---------|----------|---------|---------|-------------------
File       | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-----------|---------|----------|---------|---------|-------------------
All files  |   93.84 |    89.47 |   93.75 |   98.24 |
 crypto.ts |   91.66 |       50 |     100 |     100 | 14
 github.ts |   92.85 |      100 |    87.5 |   96.29 | 24
 utils.ts  |      96 |       90 |     100 |     100 | 22
-----------|---------|----------|---------|---------|-------------------
```

### æ ¸å¿ƒå‡½æ•°è¦†ç›–ç‡
| æ–‡ä»¶ | å‡½æ•° | æµ‹è¯•è¦†ç›– |
|------|------|----------|
| crypto.ts | encrypt | âœ… 100% |
| crypto.ts | decrypt | âœ… 100% |
| crypto.ts | hash | âœ… 100% |
| utils.ts | formatCurrency | âœ… 100% |
| utils.ts | amountToChinese | âœ… 100% |
| utils.ts | getCurrentDateTime | âœ… 100% |
| utils.ts | generateId | âœ… 100% |
| github.ts | testConnection | âœ… 100% |
| github.ts | readFile | âœ… 100% |
| github.ts | writeFile | âœ… 100% |
| github.ts | syncEvents | âœ… 100% |
| github.ts | syncGifts | âœ… 100% |

### è¦†ç›–ç‡è¯´æ˜
- **Statements**: 93.84% - è¯­å¥è¦†ç›–ç‡
- **Branch**: 89.47% - åˆ†æ”¯è¦†ç›–ç‡
- **Functions**: 93.75% - å‡½æ•°è¦†ç›–ç‡
- **Lines**: 98.24% - è¡Œè¦†ç›–ç‡

---

## ğŸš€ è¿è¡Œæµ‹è¯•

### æ‰€æœ‰æµ‹è¯•
```bash
pnpm exec jest --no-coverage
```

### å•ä¸ªæ–‡ä»¶
```bash
pnpm exec jest src/lib/crypto.test.ts --no-coverage
```

### è¯¦ç»†è¾“å‡º
```bash
pnpm exec jest --verbose --no-coverage
```

### ç›‘å¬æ¨¡å¼
```bash
pnpm exec jest --watch --no-coverage
```

---

## ğŸ”§ é…ç½®è¯¦æƒ…

### jest.config.js
```javascript
{
  testEnvironment: 'jsdom',
  setupFilesAfterEnv: ['<rootDir>/jest.setup.ts'],
  moduleNameMapper: {
    '^@/(.*)$': '<rootDir>/src/$1',
  },
  transform: {
    '^.+\\.(ts|tsx)$': ['ts-jest', { tsconfig: 'tsconfig.json' }],
  },
  testMatch: [
    '<rootDir>/src/**/*.test.{ts,tsx}',
    '<rootDir>/test/**/*.test.{ts,tsx}',
  ],
  verbose: true
}
```

### jest.setup.ts
```typescript
// Mock next/navigation
jest.mock('next/navigation', () => ({
  useRouter: () => ({
    push: jest.fn(),
    replace: jest.fn(),
    back: jest.fn(),
    forward: jest.fn(),
    refresh: jest.fn(),
  }),
  usePathname: () => '/',
  useSearchParams: () => new URLSearchParams(),
}));

// Mock next/font
jest.mock('next/font/google', () => ({
  Inter: () => ({ className: 'inter' }),
}));
```

---

## ğŸ“ æµ‹è¯•æœ€ä½³å®è·µ

### âœ… åšçš„å¥½çš„åœ°æ–¹
1. **ç‹¬ç«‹æ€§**: æ¯ä¸ªæµ‹è¯•ç‹¬ç«‹è¿è¡Œï¼Œäº’ä¸ä¾èµ–
2. **æ¸…æ™°å‘½å**: æµ‹è¯•æè¿°æ¸…æ™°ï¼Œä¸€çœ‹å°±æ‡‚
3. **è¾¹ç•Œè¦†ç›–**: åŒ…å«ç©ºå€¼ã€å¼‚å¸¸ã€è¾¹ç•Œæƒ…å†µ
4. **Mockåˆç†**: åªmockå¤–éƒ¨ä¾èµ–ï¼Œä¿æŒæµ‹è¯•çº¯ç²¹
5. **å¿«é€Ÿè¿è¡Œ**: æµ‹è¯•æ‰§è¡Œæ—¶é—´<1ç§’

### ğŸ’¡ æ”¹è¿›å»ºè®®
1. **é›†æˆæµ‹è¯•**: å¯ä»¥æ·»åŠ æ›´å¤šç«¯åˆ°ç«¯æµ‹è¯•
2. **æ€§èƒ½æµ‹è¯•**: åŠ å¯†/è§£å¯†æ€§èƒ½åŸºå‡†æµ‹è¯•
3. **UIæµ‹è¯•**: ç»„ä»¶çº§åˆ«çš„æµ‹è¯•ï¼ˆä½¿ç”¨@testing-library/reactï¼‰
4. **E2Eæµ‹è¯•**: å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯•ï¼ˆä½¿ç”¨Playwright/Cypressï¼‰

---

## ğŸ‰ æ€»ç»“

### æµ‹è¯•è´¨é‡
- âœ… **52/52** æµ‹è¯•é€šè¿‡ (100%)
- âœ… **93.84%** è¯­å¥è¦†ç›–ç‡
- âœ… **98.24%** è¡Œè¦†ç›–ç‡
- âœ… **0** ä¸ªå¤±è´¥æµ‹è¯•
- âœ… **0.5s** å¿«é€Ÿæ‰§è¡Œ

### ä¸šåŠ¡è¦†ç›–
- âœ… åŠ å¯†æœåŠ¡ï¼ˆAES-256, SHA-256ï¼‰
- âœ… å·¥å…·å‡½æ•°ï¼ˆè´§å¸ã€ä¸­æ–‡é‡‘é¢ã€IDã€æ—¥æœŸï¼‰
- âœ… GitHub APIï¼ˆè¯»ã€å†™ã€åŒæ­¥ã€é”™è¯¯å¤„ç†ï¼‰

### ä»£ç è´¨é‡
- âœ… TypeScriptç±»å‹å®‰å…¨
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†
- âœ… é”™è¯¯æ¢å¤èƒ½åŠ›
- âœ… å¯ç»´æŠ¤æ€§å¼º

---

**æµ‹è¯•å°±ç»ªï¼æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²é€šè¿‡å•å…ƒæµ‹è¯•éªŒè¯ã€‚** ğŸŠ

è¿è¡Œ `pnpm exec jest --no-coverage` æŸ¥çœ‹è¯¦ç»†ç»“æœã€‚
è¿è¡Œ `pnpm exec jest --coverage` æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Šã€‚
